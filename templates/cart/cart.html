{% extends 'base.html' %}
{% load i18n catalog_tags core_tags wishlist_tags currency_tags %}

{% block meta_title %}{{ seo_settings.cart.get_meta_title }}{% endblock %}
{% block meta_desc %}{{ seo_settings.cart.get_meta_desc }}{% endblock %}
{% block meta_keyw %}{{ seo_settings.cart.get_meta_keyw }}{% endblock %}

{% block og_title %}{{ seo_settings.cart.get_meta_title }}{% endblock %}
{% block og_desc %}{{ seo_settings.cart.get_meta_desc }}{% endblock %}

{% block twitter_title %}{{ seo_settings.cart.get_meta_title }}{% endblock %}
{% block twitter_desc %}{{ seo_settings.cart.get_meta_desc }}{% endblock %}

{% block content %}
  <style>
    .popup_form_label { color: #3d697a !important; font-size: 12px; }
    .slides_navigation {
      position: relative;
      width: 100%;
      bottom: 0;
      left: 0;
      z-index: 1;
      cursor: pointer;
      text-align: center;
    }
    .slides_navigation .dot {
      display: inline-block;
      width: 16px;
      height: 16px;
      background: #666666;
      cursor: pointer;
      border-radius: 16px;
      margin: 0 20px;
      border: 1px solid #666666;
    }
    .slides_navigation .dot.active { background: #fff; }
    .slides_details { margin-top: 20px; }
  </style>

  <main>
    <div class="main_content main_cut">

      <ul id="touch_breadcrumb" class="breadcrumb">
        <li><a href="{% url 'home' %}">{% trans 'Главная' %}</a></li>
        <li><span>{% trans 'Корзина' %}</span></li>
      </ul>

      <div id="main_content" class="wrapp_content">
        <ul class="breadcrumb">
          <li><a href="{% url 'home' %}">{% trans 'Главная' %}</a></li>
          <li><span>{% trans 'Корзина' %}</span></li>
        </ul>
        <h1 class="title_block">{{ seo_settings.cart.get_h1 }}</h1>

        <div class="rows_cut_block js-cart-parent" data-update-url="{% url 'cart_api:update' %}" data-step0-url="{% url 'cart_api:step0' %}" data-step2-url="{% url 'cart_api:step2' %}" data-step3-url="{% url 'cart_api:step3' %}">

          <div class="table_shell js-hide-if-not-cart"{% if not cart.count %} style="display: none;"{% endif %}>
            <div class="table_head">
              <div class="table_cell tb_photo"><div class="tb_title">{% trans 'Фото' %}</div></div>
              <div class="table_cell tb_model"><div class="tb_title">{% if not certificate_items %}{% trans 'Название модели' %}{% else %}{% trans 'Название' %}{% endif %}</div></div>
              {% if cart_items %}
                {% if with_color %}<div class="table_cell tb_color"><div class="tb_title">{% trans 'Цвет' %}</div></div>{% endif %}
                {# <div class="table_cell tb_fason"><div class="tb_title">{% trans 'Фасон' %}</div></div> #}
                <div class="table_cell tb_price"><div class="tb_title">{% trans 'Цена' %}</div></div>
                <div class="table_cell tb_cnt"><div class="tb_title">{% trans 'Количество' %}</div></div>
                {% if with_gift_wrapping %}<div class="table_cell tb_summ"><div class="tb_title">{% trans 'Подарочная упаковка' %}<br/>({{ gift_wrapping_price|to_price|with_currency:currency|safe }})</div></div>{% endif %}
              {% endif %}
              <div class="table_cell tb_summ"><div class="tb_title">{% trans 'Стоимость' %}</div></div>
              
              {% if cart_items %}<div class="table_cell tb_put"><div class="tb_title">{% trans 'Отложить' %}</div></div>{% endif %}
              <div class="table_cell tb_del"><div class="tb_title">{% trans 'Удалить' %}</div></div>
            </div>

            {% for item in cart_items %}
              {% get_product_attrs_url item.product item.attrs item.extra_products item.with_wrapping item.count as product_url %}

              <div class="item_content_block table_row js-item-div" data-item-id="{{ item.id }}" data-set-url="{% url 'cart_api:set' %}" data-remove-url="{% url 'cart_api:remove' %}" data-base-price="{{ item.base_price|to_price }}" data-row-clear-selector="#js-row-clear-{{ item.id }}">
                <div class="table_cell cell_image">
                  <a href="{{ product_url }}"><div class="td_photo" style="background-image:url({{ item.product.cart_cover_thumb }})"></div></a>
                </div>
                <div class="table_cell td_title">
                  <h3 class="title_upper"><a href="{{ product_url }}">{{ item.product.title }}</a></h3>
                  {% if not item.extra_products %}
                    {% if item.product.subtitle %}
                      <h4 class="title_low">{{ item.product.subtitle }}</h4>
                    {% endif %}
                  {% else %}
                    {% item_extra_products_str item as extra_products_str %}
                    {% if extra_products_str %}
                      <h4 class="title_low">{{ extra_products_str|safe }}</h4>
                    {% endif %}
                  {% endif %}
                </div>

                {% if with_color %}
                  <div class="table_cell td_color">
                    {% item_color item color_attribute as option %}
                    {% if option %}
                      <div class="td_color_box" style="border: 1px solid #ccc; {% if option.picture %}background: url('{{ option.picture_url }}'){% else %}background-color:{{ option.color }}{% endif %};" title="{{ option.title }}">{{ option.title }}</div>
                    {% endif %}
                  </div>
                {% endif %}
                
                {% comment %}
                  <div class="table_cell td_fason">
                    <span class="td_fason_box"><img src="/static/images/clotnes_acs/bott-2.jpg"></span>
                  </div>
                {% endcomment %}
                
                <div class="clr clr_table"></div>
                <div class="table_cell td_price">
                  <div class="tb_title">{% trans 'Цена' %}</div>
                  <div class="product_price">{{ item.base_price|to_price|with_currency:currency|safe }}</div>
                </div>
                <div class="table_cell td_cnt">
                  <div class="tb_title">{% trans 'Количество' %}</div>
                  <div class="number">
                    <span class="minus" id="">-</span>
                    <input type="text" name="item-count" value="{{ item.count }}" maxlength="3" onkeyup="this.value = this.value.replace(/\D/, '')" id="cnt_item-{{ forloop.counter }}" />
                    <span class="plus" id="">+</span>
                  </div>
                </div>

                {% if with_gift_wrapping %}
                  <div class="table_cell td_summ">
                    <div class="tb_title">{% trans 'Подарочная упаковка' %}</div>
                    <div>
                      <label for="gift-wrapping-{{ item.id }}" class="check_pr_input checke_lab" style="margin-top: 0;">
                        <input type="checkbox"{% if item.with_wrapping %} checked="checked"{% endif %} class="" data-wrapping-price="{{ gift_wrapping_price|to_price }}" name="gift_wrapping" id="gift-wrapping-{{ item.id }}" value="1" />
                      </label>
                    </div>
                  </div>
                {% endif %}

                <div class="table_cell td_summ">
                  {% if four_products_free %}<div class="promotion"></div>{% endif %}
                  <div class="tb_title">{% trans 'Стоимость' %}</div>
                  {% if item.discount %}
                    <div class="txt_price_to">{% trans 'Цена для вас' %}:</div>
                    <div class="product_price sale_price">{% prefix_currency currency item.total_price_without_discount %}<s class="item-base-summary-span" style="font-family: NeoRegular;">{{ item.total_price_without_discount }}</s>{% postfix_currency currency item.total_price_without_discount %}</div>
                    <div class="product_price" style="color: #8c2c34;">{% prefix_currency currency item.price|to_int_or_float %}<span class="js-cart-price item-summary-span">{{ item.price|to_int_or_float }}</span>{% postfix_currency currency item.price|to_int_or_float %}</div>
                  {% elif item.promotion %}
                  <div class="txt_price_to">{% trans 'Цена по акции' %}:</div>
                    <div class="product_price sale_price">{% prefix_currency currency item.total_price_without_discount %}<s class="item-base-summary-span" style="font-family: NeoRegular;">{{ item.total_price_without_discount }}</s>{% postfix_currency currency item.total_price_without_discount %}</div>
                    <div class="product_price" style="color: #8c2c34;">{% prefix_currency currency item.price|to_int_or_float %}<span class="js-cart-price item-summary-span">{{ item.price|to_int_or_float }}</span>{% postfix_currency currency item.price|to_int_or_float %}</div>
                  {% else %}
                    <div class="product_price">{% prefix_currency currency item.price|to_price %}<span class="item-summary-span" id="price_ID-{{ forloop.counter }}">{{ item.price|to_price }}</span>{% postfix_currency currency item.price|to_price %}</div>
                  {% endif %}
                </div>
                
                <div class="table_cell td_put">
                  <a href="#" class="butt_put">
                    <label for="put_item{{ forloop.counter }}" class="td_label_check_win">
                      <input type="checkbox" name="put_item" id="put_item{{ forloop.counter }}" value="1"
                             class="js-wishlist-input js-from-cart-page js-with-data-count"
                             data-add-url="{% url 'wishlist:add' %}" data-remove-url="{% url 'wishlist:remove' %}"
                             data-product-id="{{ item.product_id }}" data-option-id="{{ item.option_id }}"
                             data-price="{{ item.base_price_without_discount }}"
                             data-count="{{ item.count }}"
                             data-attrs='{{ item.attrs|to_json|safe }}'
                             data-extra-products='{{ item.extra_products|to_json|safe }}' />
                      <div class="window_title">
                        <span class="no_check">{% trans 'Добавить товар в список желаемых покупок' %}</span>
                        <span class="y_check">{% trans 'Товар в списке желаемых покупок' %}</span>
                      </div>
                      <img src="/static/i/heart_icon.png" alt="{% trans 'Отложить' %}" />
                    </label>
                  </a>
                </div>
                <div class="table_cell td_del">
                  <a href="#" class="butt_del js-remove-item"><img src="/static/i/delete.gif" alt="{% trans 'Удалить' %}" /></a>
                </div>
              </div>

              {% if not forloop.last or certificate_items.count %}
                <!--разделитель между товарами--><div class="item_content_block table_row table_row_clr" id="js-row-clear-{{ item.id }}"><div class="table_cell">&nbsp;</div></div>
              {% endif %}
            {% endfor %}

            {% for item in certificate_items %}
              <div class="item_content_block table_row js-item-div" data-item-id="{{ item.id }}" data-set-url="{% url 'certificate_api:set' %}" data-remove-url="{% url 'certificate_api:remove' %}" data-row-clear-selector="#js-row-clear-{{ item.id }}">
                <div class="table_cell cell_image">
                  <a href="{{ item.url }}"><div class="td_photo" style="background-image:url({{ item.certificate.cart_cover_thumb }})"></div></a>
                </div>
                <div class="table_cell td_title">
                  <h3 class="title_upper"><a href="{{ item.url }}">{{ item.title }}</a></h3>
                  <h4 class="title_low">
                    {% trans 'Для' %} {{ item.recipient_name }}
                    {% if not item.send_immediately and item.send_date %}
                      <br/>{% trans 'Отправить' %} {{ item.send_date|date:'d.m.Y' }}
                    {% endif %}
                  </h4>
                </div>

                {% if cart_items %}
                  {% if with_color %}<div class="table_cell td_color"></div>{% endif %}
                  <div class="clr clr_table"></div>
                  <div class="table_cell td_price"></div>
                  <div class="table_cell td_cnt"></div>
                  {% if with_gift_wrapping %}<div class="table_cell td_summ"></div>{% endif %}
                {% endif %}

                <div class="table_cell td_summ">
                  <div class="tb_title">{% trans 'Стоимость' %}</div>
                  <div class="product_price">{% prefix_currency currency item.price|to_price %}<span class="item-summary-span" id="price_ID-{{ forloop.counter }}">{{ item.price|to_price }}</span>{% postfix_currency currency item.price|to_price %}</abbr></div>
                </div>
                
                {% if cart_items %}<div class="table_cell td_put"></div>{% endif %}
                <div class="table_cell td_del">
                  <a href="#" class="butt_del js-remove-item"><img src="/static/i/delete.gif" alt="{% trans 'Удалить' %}" /></a>
                </div>
              </div>

              {% if not forloop.last %}<!--разделитель между товарами--><div class="item_content_block table_row table_row_clr" id="js-row-clear-{{ item.id }}"><div class="table_cell">&nbsp;</div></div>{% endif %}

            {% endfor %}
                      
          </div>

          <div class="js-show-if-not-cart" style="margin-bottom: 250px;{% if cart.count %} display: none;{% endif %}">
            <h3>{% trans 'Товаров в корзине нет' %}. <a href="{% url 'women' %}">{% trans 'Вернуться в каталог' %}</a></h3>
            {% if settings.cookies_cart %}<br/><p class="js-show-if-not-cart">{{ settings.cookies_cart|linebreaksbr }}</p>{% endif %}
          </div>

          <div class="rows_block_info js-hide-if-not-cart"{% if not cart.count %} style="display: none;"{% endif %}>
            {% if delivery_methods.count %}
              <div class="row_info">
                <h2 class="title_block">{% trans 'Выбор способа доставки' %}</h2>
                <div class="rows_radio_block js-method-inputs-parent">
                  {% for method in delivery_methods %}
                    <label for="delivery_method_{{ method.id }}" class="radio_input js-delivery-method-label" data-delivery-method-id="{{ method.id }}">
                      <div class="shell_cell_row">
                        <div class="input_cell"><input type="radio" name="delivery_method_id" value="{{ method.id }}" id="delivery_method_{{ method.id }}" data-payment-ids="{{ method.payment_ids }}" class="check_radio js-choose-cart-method"{% if shipping_data.delivery_method_id == method.id or delivery_methods.count == 1 %} checked="checked"{% endif %}/></div>
                        <p class="dott_cell"><strong><span>{{ method.title }}</span></strong><span class="val_radio_row">Стоимость: {{ method.price|to_price|with_currency:currency|safe }}</span></p>
                      </div>
                    </label>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
            
            {% if payment_methods.count %}
              <div class="row_info">
                <h2 class="title_block">{% trans 'Выбор способа оплаты' %}</h2>
                <div class="rows_radio_block js-method-inputs-parent">
                  {% for method in payment_methods %}
                    <label for="payment_method_{{ method.id }}" class="radio_input js-payment-method-label" data-payment-method-id="{{ method.id }}">
                      <div class="shell_cell_row">
                        <div class="input_cell"><input type="radio" name="payment_method_id" value="{{ method.id }}" id="payment_method_{{ method.id }}" data-delivery-ids="{{ method.delivery_ids }}" class="check_radio js-choose-cart-method"{% if shipping_data.payment_method_id == method.id or payment_methods.count == 1 %} checked="checked"{% endif %}/></div>
                        <p><strong class="no_dash"><span>{{ method.title }}</span></strong></p>
                      </div>
                    </label>
                  {% endfor %}
                </div>
              </div>
            {% endif %}

          </div>

          <h2 class="title_block js-hide-if-not-cart"{% if not cart.count %} style="display: none;"{% endif %}>{% trans 'Дополнительная информация' %}</h2>
          <textarea name="additional_info" rows="9" id="text" class="t_area js-hide-if-not-cart"{% if not cart.count %} style="display: none;"{% endif %}>{% if basket.additional_info %}{{ basket.additional_info }}{% endif %}</textarea>
          
          <div class="foot_form_cut">
            <div class="foot_form_cut_row">
              <h2 class="title_block">{% trans 'Итого товаров' %}: <span class="price_table_summ"><span class="js-cart-count">{{ cart.count }}</span> {% trans 'на сумму' %} <div class="product_price">{{ cart.summary|with_js_cart_summary:currency|safe }}</div></span></h2>
              
              {% include 'blocks/currency_change.html' %}
            </div>
            <button class="bt_red js-step0-button js-disabled-if-not-cart{% if not cart.count %} _disabled{% endif %}">{% trans 'Оформить заказ' %}</button>
          </div>
          
        </div>
        
        <!--div class="text_preview_page text_item">
          <div class="text_preview_inner">
            
          </div>
        </div-->
        
      </div>
      
    </div>
  </main>
{% endblock %}

{% block popups %}
  <div style="display: none">
    <a rel="leanModal1" href="#error-popup"></a>
    <a rel="leanModal1" href="#step1"></a>
    <a rel="leanModal1" href="#step2"></a>
    <a rel="leanModal1" href="#step3"></a>
    <a rel="leanModal1" href="#step4"></a>
    <a rel="leanModal1" href="#step5"></a>
    <div id="js-paypal-form-container"></div>
  </div>

  <div class="window_popup no_float mini_window_popup callback_form" id="error-popup" style="display:none;">
      <div class="close_popup call_close js-call-close"><img src="/static/i/close_white_45.png" alt="{% trans 'Закрыть' %}"></div>
      <div class="wrap_window_popup bg_wrapp_window">
          <div class="popup_row">
              <div class="popup_row_wrapp">
                  <h3 class="popup_title" style="margin-bottom: 10px;">{% trans 'При отправке формы произошла ошибка' %}:</h3>
                  <p class="call_introtext popup_text"></p>
                  {% comment %}
                  <div class="red_bor_butt">
                      <span class="js-call-close usual_link">{% trans 'Закрыть' %}</span>
                  </div>
                  {% endcomment %}
                  <div class="bt_req_call red_bor_butt js-call-close">
                    <button class="butt_border">{% trans 'Закрыть' %}</button>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <div class="window_popup_but" id="step1" style="display: none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="Закрыть"></div>
    <div class="wrap_window_popup">
      <div class="popup_row_but js-show-popup" data-popup-id="#step1-login">
        <div class="popup_row_wrapp">
          <span class="title_popup_but">{% trans 'Я уже покупал на сайте' %}</span>
        </div>
      </div>
      <div class="popup_row_but js-show-popup" data-popup-id="#step1-registration">
        <div class="popup_row_wrapp">
          <span class="title_popup_but">{% trans 'Я покупаю в первый раз' %}</span>
        </div>
      </div>
    </div>
    <a rel="leanModal1" style="display: none;" href="#step1-login">{% trans 'Я уже покупал на сайте' %}</a>
    <a rel="leanModal1" style="display: none;" href="#step1-registration">{% trans 'Я покупаю в первый раз' %}</a>
  </div>


  <!-- форма авторизации-->

  <div class="window_popup_reg" id="step1-login" style="display: none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="Закрыть"></div>
    <div class="wrap_window_popup">
      <div class="popup_row_reg">
        <div class="popup_row_wrapp">
          <p class="popup_back_wrap">
            <span class="js-show-popup popup_back" data-popup-id="#step1">&larr; {% trans 'Шаг назад' %}</span>
            <a rel="leanModal1" style="display: none;" href="#step1">&larr; {% trans 'Шаг назад' %}</a>
          </p>
          <h2 class="title_popup">{% trans 'Я уже являюсь <br>клиентом BIKINIMINI' %}</h2>

          <form class="js-step1-form js-step1-login-form" action="{% url 'auth:login' %}" method="post">
            <div class="error-messages"></div>

            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш e-mail' %}</p>
                <input type="email" required="required" value="" name="email" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль' %}</p>
                <input type="password" required="required" value="" name="password" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box check_popup_row">
                <input class="check_form" type="checkbox" name="remember_me">
                <p>{% trans 'Запомнить меня на сайте' %}</p>
              </label>
            </div>
            
            <div class="row_form_popup row_pop_butt">
              <button class="bt_red">{% trans 'Войти' %}</button>
              <span class="js-show-popup" data-popup-id="#reset_password">{% trans 'Забыли пароль?' %}</span>
              <a rel="leanModal1" style="display: none;" name="reset_password" href="#reset_password">{% trans 'Забыли пароль?' %}</a>
            </div>
            
            <div class="row_form_popup">
              <p>{% trans 'Войти при помощи соц. сетей' %}:</p>
              <div class="soc_enter">
                <a href="{% url 'auth:social:fb' %}"><img src="/static/i/soc_face.png" alt="{% trans 'Facebook' %}"></a>
                <a href="{% url 'auth:social:vk' %}"><img src="/static/i/soc_vk.png" alt="{% trans 'ВКонтакте' %}"></a>
                <a href="{% url 'auth:social:gp' %}"><img src="/static/i/soc_gplus.png" alt="{% trans 'Google Plus' %}"></a>
                {% comment %} <a href="{% url 'auth:social:ig' %}"><img src="/static/i/soc_ins.png" alt="{% trans 'Instagram' %}"></a> {% endcomment %}
              </div>
            </div>

          </form>
        </div>
        </div>
      </div>
   </div>   

  <!-- форма регистрации -->

  <div class="window_popup_reg" id="step1-registration" style="display: none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="Закрыть"></div>
    <div class="wrap_window_popup bg_wrapp_window">
      <div class="popup_row_reg bg_popup">
        <div class="popup_row_wrapp">
          <p class="popup_back_wrap">
            <span class="js-show-popup popup_back" data-popup-id="#step1">&larr; {% trans 'Шаг назад' %}</span>
            <a rel="leanModal1" style="display: none;" href="#step1">&larr; {% trans 'Шаг назад' %}</a>
          </p>
          <h2 class="title_popup">{% trans 'Я новый <br>клиент BIKINIMINI' %}</h2>

          <form class="js-step1-form js-step1-registration-form" action="{% url 'auth:registration' %}" method="post">
            <div class="error-messages"></div>

            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш e-mail' %}</p>
                <input type="email" required="required" value="" name="email" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль' %}</p>
                <input type="password" required="required" value="" name="password" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль ещё раз' %}</p>
                <input type="password" required="required" value="" name="password_repeat" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'ФИО' %}</p>
                <input type="text" required="required" value="" name="name" class="input_text">
              </label>
            </div>

            <div class="row_form_popup">
              <label class="lbl_box check_popup_row">
                <input class="check_form" type="checkbox" name="subscription" style="margin-right: 5px;">
                <p style="float: none;">{% trans 'Я хочу получать информацию о скидках и новинках' %}</p>
              </label>
            </div>

            <div class="row_form_popup row_pop_butt">
              <button class="bt_red">{% trans 'Далее' %}</button>
            </div>
          </form>
          
          <div class="row_form_popup">
            <p>{% trans 'Войти при помощи соц. сетей' %}:</p>
            <div class="soc_enter">
              <a href="{% url 'auth:social:fb' %}"><img src="/static/i/soc_face.png" alt="{% trans 'Facebook' %}"></a>
              <a href="{% url 'auth:social:vk' %}"><img src="/static/i/soc_vk.png" alt="{% trans 'ВКонтакте' %}"></a>
              <a href="{% url 'auth:social:gp' %}"><img src="/static/i/soc_gplus.png" alt="{% trans 'Google Plus' %}"></a>
              {% comment %} <a href="{% url 'auth:social:ig' %}"><img src="/static/i/soc_ins.png" alt="{% trans 'Instagram' %}"></a> {% endcomment %}
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  {% comment %}
  <div class="window_popup" id="step1" style="display: none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="{% trans 'Закрыть' %}"></div>
    <div class="wrap_window_popup bg_wrapp_window">
      <div class="popup_row">
        <div class="popup_row_wrapp">
          <h2 class="title_popup">{% trans 'Я уже являюсь <br>клиентом BIKINIMINI' %}</h2>

          <form class="js-step1-form js-step1-login-form" action="{% url 'auth:login' %}" method="post">
            <div class="error-messages"></div>

            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш e-mail' %}</p>
                <input type="email" required="required" value="" name="email" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль' %}</p>
                <input type="password" required="required" value="" name="password" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box check_popup_row">
                <input class="check_form" type="checkbox" name="remember_me">
                <p>{% trans 'Запомнить меня на сайте' %}</p>
              </label>
            </div>
            
            <div class="row_form_popup row_pop_butt">
              <button class="bt_red">{% trans 'Войти' %}</button>
              {# <a href="#">{% trans 'Забыли пароль?' %}</a> #}
            </div>
            
            <div class="row_form_popup">
              <p>{% trans 'Войти при помощи соц. сетей' %}:</p>
              <div class="soc_enter">
                <a href="{% url 'auth:social:fb' %}"><img src="/static/i/soc_face.png" alt="{% trans 'Facebook' %}"></a>
                <a href="{% url 'auth:social:vk' %}"><img src="/static/i/soc_vk.png" alt="{% trans 'ВКонтакте' %}"></a>
                <a href="{% url 'auth:social:gp' %}"><img src="/static/i/soc_gplus.png" alt="{% trans 'Google Plus' %}"></a>
                <a href="{% url 'auth:social:ig' %}"><img src="/static/i/soc_ins.png" alt="{% trans 'Instagram' %}"></a>
              </div>
            </div>

          </form>

        </div>
      </div>
      
      <div class="or_block">{% trans 'или' %}</div>
      
      <div class="popup_row bg_popup">
        <div class="popup_row_wrapp">
          <h2 class="title_popup">{% trans 'Я новый <br>клиент BIKINIMINI' %}</h2>

          <form class="js-step1-form js-step1-registration-form" action="{% url 'auth:registration' %}" method="post">
            <div class="error-messages"></div>

            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш e-mail' %}</p>
                <input type="email" required="required" value="" name="email" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль' %}</p>
                <input type="password" required="required" value="" name="password" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'Ваш пароль ещё раз' %}</p>
                <input type="password" required="required" value="" name="password_repeat" class="input_text">
              </label>
            </div>
            
            <div class="row_form_popup">
              <label class="lbl_box">
                <p>{% trans 'ФИО' %}</p>
                <input type="text" required="required" value="" name="name" class="input_text">
              </label>
            </div>

            <div class="row_form_popup">
              <label class="lbl_box check_popup_row">
                <input class="check_form" type="checkbox" name="subscription" style="margin-right: 5px;">
                <p style="float: none;">{% trans 'Я хочу получать информацию о скидках и новинках' %}</p>
              </label>
            </div>

            <div class="row_form_popup row_pop_butt">
              <button class="bt_red">{% trans 'Далее' %}</button>
            </div>
          </form>
          
        </div>
      </div>
      
    </div>
  </div>
  {% endcomment %}

  {% comment %}
  <div class="window_popup no_float mini_window_popup callback_form" id="step2" style="display:none;">
      <div class="close_popup call_close js-call-close"><img src="/static/i/close_white_45.png" alt="{% trans 'Закрыть' %}"></div>
      <div class="wrap_window_popup bg_wrapp_window">
          <div class="popup_row">
              <div class="popup_row_wrapp">
                  <h3 class="popup_title" style="margin-bottom: 10px;">Шаг 2!</h3>
                  <p class="call_introtext popup_text"></p>
                  <div class="bt_req_call red_bor_butt js-call-close">
                    <button class="butt_border">{% trans 'Закрыть' %}</button>
                  </div>
              </div>
          </div>
      </div>
  </div>
  {% endcomment %}

  <div class="window_popup no_float" id="step3" style="display:none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="{% trans 'Закрыть' %}" /></div>
    <div class="wrap_window_popup bg_wrapp_window">
      <div class="popup_row">
        <div class="popup_row_wrapp">
          <h2 class="title_popup">{% trans 'Данные для доставки' %}</h2>
          <form class="js-step3-form" action="{% url 'cart_api:step3' %}" method="post">
            <div class="error-messages"></div>

            <div class="rows_popup_input">
              <div class="row_form_popup">
                <label class="lbl_box">
                  <p>{% trans 'Страна' %}:<span class="orange_text">*</span></p>
                  <select required name="country" value="{{ shipping_data.country }}" class="country_select">
                    {% for country in countries %}
                      <option value="{{ country.id }}"{% if country.id == shipping_data.country %} selected="selected"{% endif %}>{{ country.title }}</option>
                    {% endfor %}
                  </select>
                </label>
              </div>
              
              <div class="row_form_popup">
                <label class="lbl_box">
                  <p>{% trans 'Город' %}:<span class="orange_text">*</span></p>
                  <input required type="text" value="{{ shipping_data.city }}" name="city" class="input_text" />
                </label>
              </div>
            </div>

            <div class="rows_popup_input">
              <div class="row_form_popup">
                <label class="lbl_box">
                  <p>{% trans 'Почтовый индекс' %}:</p>
                  <input type="text" value="{{ shipping_data.postal_code }}" name="postal_code" class="input_text" />
                </label>
              </div>
              <div class="row_form_popup"></div>
            </div>

            <div class="rows_popup_input">
              <label class="lbl_box">
                <p class="popup_form_label">{% trans 'Адрес' %}:<span class="orange_text">*</span></p>
                <textarea required name="address" class="input_text no_hover_border" style="padding: 12px 2.25% 0; width: 95.45%; height: 135px;">{{ shipping_data.address }}</textarea>
              </label>
            </div>            
            
            <div class="rows_popup_input">
              <div class="row_form_popup">
                <label class="lbl_box">
                  <p>{% trans 'Контактный телефон' %}:<span class="orange_text">*</span></p>
                  <input required type="text" value="{{ shipping_data.phone }}" name="phone" class="input_text" />
                </label>
              </div>
              
              <div class="row_form_popup">
                <label class="lbl_box">
                  <p>{% trans 'Имя, Фамилия, Отчество' %}:<span class="orange_text">*</span></p>
                  <input required type="text" value="{{ shipping_data.name }}" name="name" class="input_text" />
                </label>
              </div>
            </div>

            {% if not shipping_data.email %}
              <div class="rows_popup_input js-email-cart-input" style="margin-bottom: 15px; display: none;">
                <label class="lbl_box">
                  <p class="popup_form_label">{% trans 'Ваш e-mail' %}:</p>
                  <input type="email" style="margin-top: 5px;" value="{{ shipping_data.email }}" name="email" class="input_text" />
                </label>
              </div>
            {% endif %}

            <div class="row_form_popup">
              <label class="lbl_box check_popup_row">
                <input class="check_form" type="checkbox" checked name="agree" style="margin-right: 5px;" required="required">
                <p style="float: none;">{% trans 'Я cогласен на обработку персональных данных' %} <a href="/agree/" target="_blank">{% trans 'Читать' %}</a></p>
              </label>
            </div>

            <div class="row_form_popup row_pop_butt">
              <button class="bt_red">{% trans 'Оформить заказ' %}</button>
            </div>
            
          </form>
        </div>
      </div>
      
      
    </div>
  </div>

  <div class="window_popup no_float mini_window_popup" id="step4" style="display:none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="{% trans 'Закрыть' %}" /></div>
    <div class="wrap_window_popup bg_wrapp_window">
      <div class="popup_row">
        <div class="popup_row_wrapp">
          <h2 class="title_popup">{% trans 'Заказ успешно <br />оформлен' %}</h2>
          <div class="row_form_popup">
            <p><strong>{% trans 'Заказ №' %}:</strong><span class="js-order-number">111 111</span></p>
            <p><strong >{% trans 'На сумму' %}:</strong>{{ '11 111'|with_js_cart_summary:currency|safe }}</p>
            {# <p><strong>{% trans 'Способ получения' %}:</strong><span>Самовывоз</span></p> #}

            {% comment %}
            <p style="margin-top: 30px;">{% blocktrans trimmed 'В ближайшее время с вами свяжутся 
            менеджеры отдела доставки для уточнения 
            деталей заказа' %}</p>

            <p>{% blocktrans trimmed 'Если у вас возникли какие либо вопросы,
            вы можете связаться с нами по телефону' %}
            <strong class="pup_strong">+7 (902) 354-38-45</strong></p>
            {% endcomment %}

            <p style="margin-top: 30px;">В ближайшее время с вами свяжутся 
            менеджеры отдела доставки для уточнения 
            деталей заказа</p>

            <p>Если у вас возникли какие либо вопросы,
            вы можете связаться с нами по телефону
            <strong class="pup_strong">+7 (902) 354-38-45</strong></p>

            <p><p>{% trans 'С уважением, администрация Bikinimini.ru' %}</p></p>
          </div>

          {# <a href="{% url 'women' %}" class="to_cart_list">{% trans 'Продолжить покупки' %}</a> #}
        </div>
      </div>
    </div>
  </div>

  <div class="window_popup after_popup" id="step5" style="display:none;">
    <div class="close_popup js-call-close"><img src="/static/i/close_icon.png" alt="{% trans 'Закрыть' %}" /></div>
    <div class="wrap_window_popup bg_wrapp_window">
      <div class="popup_row">
        <div class="popup_row_wrapp">
          <h2 class="title_string">{% trans 'Ваш заказ принят' %}!</h2>
          <div>№ заказа: </strong><span class="js-order-number">111 111</span><br/></div>
          <div class="content_pup">
            <div class="p_pup">{% trans 'Итоговая стоимость заказа' %}:</div> 
            <div class="product_price upper_price price_strong">{{ '11 111'|with_js_cart_summary:currency|safe }}</div>

            <p style="margin-top: 30px;">В ближайшее время с вами свяжутся 
            менеджеры отдела доставки для уточнения 
            деталей заказа</p>

            <p>Если у вас возникли какие либо вопросы,
            вы можете связаться с нами по телефону
            <strong class="pup_strong">+7 (902) 354-38-45</strong></p>

            <p><p>{% trans 'С уважением, администрация Bikinimini.ru' %}</p></p>
          </div>

          {# <a href="{% url 'women' %}" class="to_cart_list">{% trans 'Продолжить покупки' %}</a> #}
        </div>
      </div>

      <div class="popup_row bg_popup js-step5-specials"></div>

    </div>
  </div>

{% endblock %}

{% block extra_js %}
  <script type="text/javascript">
    // {% include 'js/product.js' %}
    // {% include 'js/wishlist.js' %}
    {% include 'js/cart.js' %}
  </script>

  <script type="text/javascript">
    $(document).ready(function() {
      checkCartMethods();    
    });
  </script>
{% endblock %}
